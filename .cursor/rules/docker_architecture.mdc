---
globs: Dockerfile,docker-compose.*.yml
alwaysApply: false
---
# Docker Architecture

## Base Images
- `qtapp-qt-dev-env:latest` – Qt 6 SDK, CMake, build tools (builder stage).
- `qtapp-qt-runtime:latest` – Qt 6 runtime libs only (runtime stage).

## Build Pattern
```dockerfile
FROM qtapp-qt-dev-env:latest AS builder
WORKDIR /lesson
COPY CMakeLists.txt main.cpp ./
RUN mkdir build && cd build && cmake .. -DCMAKE_BUILD_TYPE=Release && cmake --build . && cmake --install .

FROM qtapp-qt-runtime:latest AS runtime
WORKDIR /opt/lesson##
COPY --from=builder /opt/lesson##/<executable> .
CMD ["./<executable>"]
```

## Storage Efficiency
- All lessons share the runtime base (~611 MB).
- Each lesson adds ~40 KB (the executable).
- Total for 28 lessons ≈ 612 MB.
- Never introduce alternative base images.
